import struct
from base64 import b64decode

from cryptography.hazmat.primitives.serialization.pkcs12 import load_pkcs12

test_keystore = b64decode('''MIIQvwIBAzCCEHUGCSqGSIb3DQEHAaCCEGYEghBiMIIQXjCCBlIGCSqGSIb3DQEHBqCCBkMwggY/AgEAMIIGOAYJKoZIhvcNAQcBMFcGCSqGSIb3DQEFDTBKMCkGCSqGSIb3DQEFDDAcBAhgZJ49jC/MhgICCAAwDAYIKoZIhvcNAgkFADAdBglghkgBZQMEASoEENL+G14S4qOj4isXpEZQOhmAggXQLE3zki5u/AO9cdxL1al4zQ6XXGfqCx7Luu7wtZF5XkUxw/I1D3eut1DYFE0JNDzUaB1FnyuthgPKqFDL664bQPy7Dds50cSMpndGicBknsRjFpAnGzy7Pj1FK4nLIhPLKIGRsSWQEEtIDLxgpjX6xBZvvqyUagFhSP2IxAPWBMFxKNWKMPI9TGGvRmT8tMe1XMMjMUNU7Kcrg93FqLS7jk+DQTLeUwijSy/rKAh1ohamqAdmxhWmhLqj/gOtIawt5CLmYtmtWUzcQ21yj2LboyoZRHG3tpUu7UTMf+V4hsW1zEACSFixj/VkaZeixdYs/zj/zRoCTFTEx5migh8U/OCPFmTd/v6ay1UyVhRkwcp9CZ3gYJDmgIs2cwpYYcpB3PfSZwBekN/i3OXFQHfd6dUHq6jV1JvNGMSfDb5lQnhiO4irwKdxIMuBq2l/zESOk2MvTPrxlpSmVr8m2tQwI+ys+Kf61DQw8/y61AylpHtvoFYG8VT0iv+BtW8vP5EroZQCfS9Cy97/3rbNrjvppHvtkRTYsnVsPb1gy1UZfuDFZOdGXGFpEaCDUAxTigYZZUtIve4LZDce4m1drN4hlbhkpYxCIR3dsc9qlTdII5B22BQrG1kn1lwDQsTfnj41imp2qQF1TKxpUSLjqmjnTJf/qT4qQ9uQsJq0w6hnIzli6nMkuev8rykbSzGCXs4bLLtOCmwpq1aoowMuLQ/aEEUTVXdxC59irYJLJAX3YAg9g0rwU3Q588TjDOuEILJY1Q44/vjS5ujz9TyXGEJXia7f+K0/2ecCEB3bwC5JmozQPTZxpI99ovbO4XrjlKTIjA1zDPHd4S4oGMxiT/WluHFAapf+l1qBmc7pcfq+wzKqEXZv8X/j3/gcS/H0UcLzYHBqU+o65S9qD3PoN0cRguE/BV3K9pEf4vN4eimo9BiDL+Sccnia5U5AE9FGDGdbApYygvv1l34fdTm9zNvwuC86mbfbQMmjJbHiFBLTnJZFaKUKY/znxeRNkHJ3bTQz4v/MEBUUI9g/k7mECD/N7of0fFz3vuJHIHjBCG1TV2Eyr0YyFwjmDy4Ag62KwMnKaAPDRVeJkBI7jAGGzC2Td6cn320ZPX3fVqwH0fdYlM78XFcvsD2x+OQAuq9Tcd6KZIYevlwu6mh5+ZRXiTG32IspcbHqmsRL0U2m18RcEkHMJ2b1aTJPJCjmnqyfClh2AQOxF4ttsfO1WBHpbzpkL4kwNBRdTuYQ5Luxsge55NnXyDpKY9R1xzkNBvM/t+LJLNE5VAPd9ESZLJXIYizZn9qass8KtAKiSeuycxIZFrYyPjJybFdCZIe35Pty5V7N3krO1wHzPrcFb8wH0l0rTM20eaFUxOrca0XAFID6M1w1mXa2jpdFokHcJ+14Lh4fR9sOSwJAWOdMDXbt9ivliUZ1wdkxdXslbFWD+/3si136Y7uNSoNkjqq2kF+FyZ4tg1aVPCrQvob80ftd12CpeUb6mj7BxfEPlyPCBA9W0EDcIINv/M5P8eD0KqsyLhmz9SB/OIiCc/2TiJgQxsEpkG/6LZ73vgjHeqvd08aHc5h+sTc9mwjo8xRdgzhg36bKzAUqclow4iOExVLkm0Si2srzUTym4zUpa7D3bad8YGg8jK+CH33Ukilrer6YMNwpefuW62oxuF+MKsb4fcrePrUpxY7ZzH9lgfabtZBeQAIEulWnLojjLFSIja9gV9PLAAasFHRD7WbfMLkX1JcDmXy6VtZudMiUMbvJfCDP0l9A0uRnBkDiIp//dVZCZ3ohzWSgdqkfYAARBXUeympuy7OSxndhe+qqqRPu9iXzqrLSeVy+E635yFtfcJyqefK4eGWDrTo14A4VNoeHU/G1naUdbUOijvx9URuk3s/QqStpxIqW+ITYlPwvCwb8MB7gHE4ODqtjEGaX7JFOoMAoLmg8pVuSHYwxsMKw6MpXYpfh0yJrtCamfnoTGc1D818hMIIKBAYJKoZIhvcNAQcBoIIJ9QSCCfEwggntMIIJ6QYLKoZIhvcNAQwKAQKgggmxMIIJrTBXBgkqhkiG9w0BBQ0wSjApBgkqhkiG9w0BBQwwHAQI6+nBw2pJeqECAggAMAwGCCqGSIb3DQIJBQAwHQYJYIZIAWUDBAEqBBDcZAq3ANncKhfksjn+BhQFBIIJUHZPgw3LkGcYmkDqvijM6Sa8RU10Uu2lXz9eT1MOKNf79ay/KtQn9EVSp37N2L3EfZ/NoDGYHsJH8gCSbhIZPWAIgbQz8ffUBpUt0W5DR2nDUGdv1f3rU1FXjUBelqADWX5ILIiyazaWiG6W24r8v2c5yVbrzibwsAUFsmLCeo9ymdokLcSj789eOzRUdHo+ktFGNmgwKRk4ftgXcDLVfybCarYhq7m5YaNY/jTs7qgvc2QPLaBly66p0skVcHrRdidFzJdmUu+qIcPMfenPBicds5R4BAZvu7fCHKpJdn41LCzMxcYZffPM7ZzxEELWzsLJmluvH+h2KWdYTHe2qRkc8RPMQp2V4GHNv671kCK8SZzegzVZUqTLRjvHNKhMBqGU9h9IiapesV63CrHmnBh/nocvnqJs2saGx9kiSnE1xvOPy4UjlE+7aThngtaz45xYg67os+a6otRIW0GUmOTAe7L5jML9XaFuKRKqOgMhLOA6q/pK4eu9aH871jP5OH+qj5/Shiif2ZxNDsfAx9SQy8HWIrFgswikP0kQvKnAPFzAcR9mcDQtVenN6dhgl1ryP8IqIZ1XittUGhmgp2F2RiVPTennN3kBFYsTsUOTN4biLdTo9tATc4plOH7ONeapR4myWsSHV/Oop7ccr+aYOTib6NW+Zn4TRU1W+nFbf/xZnnsrZ9cNYaEJO2izLYTzBeMXnhBfThy7Wx4WKKXqej794YgxznQFLbwtdYgbZs+gwh8Gn8lwsu9AFSb1F0EL5P++S7CMLZRxdrnYrNqQIrh4mjIa1Xm4rmpE2Xuz4ySq1wqQv1H66sUQa9LdZYEKSUXqlN+w0I2ZtTsF8wXMIeztpKH/WMpVVfQv32prkmLYhfCAu/jxFjG8ysHF05V4AKZFd1kxZGQU1A0yqy9LccQGciH7w9fK+hfWDGWL8bCS4uYuPkJ8AhsxB6EqqXrBVJs5ur86ssPwIgWwBtYZ4G+Z1ztoEtt4FgEj3QUthLjxhWvg5BOzjKUaRRgj8p9cFNgG+A/fcW/Hvb4tDIqsR1bgstoGnDNa8NIKVJTqPL6cFvb+gltVyTeGrhvnhdwAB7Fb/tWGAoyf+hFj5qGgruOXLpJapppC3FQ5E1fj+V7x2605L8efepTrmYYnE9ggqZ9g28moky/PSW28/Rg+8kmQtJ9kkg4JwxuJRPpyzFahExosD9qXEFE3zhJJCXFX+UfO5Tjm7+GhD14oZ6tB0nTMgSQQLgKOxm67pZdgr0tRxFEChx5lAfMjiQaMAoUJLR77GBAMt05PD7pynRKmbFE4Un+gdjexbXac1bKxFdc3EksnOT3giVMVh2FSUAiwY+rV61cox4LAS/UgjlSEjjHOvj3o+aQjq0vvzQivGTObah8YrJCcs+TJ6+PrSHGnaPcOFKm/K3YS9rs6TUrKhtj8Dj0GaxA/BPjeHyd7MW4t2BbzINjH12ejrwXDHRqtEJ9Gviy8nrAKlsZOdeJ4F7lQQaGfzyFiDVbIsS5MN8rLqToKYhyWQ4GE+2Sg16h7FFrCqJ+1ZKP2OglEEt19uRdNBnI1020b8DLzpu4/6giwc6vjLyw7mMq9cdxAjZ+ELOPsECotFtLXQS2sNqypPJ6g0uLcNCyqRNrLxsL8dW807U3iz3ATD03YAnqqlna+65meOiT08nCIvpq2ubtvh3+QXlBScoZReZYMHhDleA/ogpzL8TxVshvqrN+fjUIjGsyRZdZMUc1INoT3KNJDueCaavLJ2LUYnhZuJAGuZbPcxpF63pt5ne0BYySJASH3/vgOY0GHPL8cd4uLvcHC6aBmdMEaVjxhevqt0lP9M+Zj8l5QyId7TjNbes7VvwaOAV5LQ83irSw9aaQ3BfvJmVGeabigKZ19qM+5m4FJM29uiYdPCd59yaIVtNuo2HL2PlTVfQeVXfYdKtlD8F3Egww0LKlAo3BJxFi4zBtzuh9xpR7/R6Hq++LBw7HyVjtbaNZV5a/lxSaG2nfa5XuFmuCdeXYHfuwuCIXrTND5IYdgBEzeVFeaBbR0pu4SnpBnMVCagP4bA0ctajChkSueFG38hsWb3k/WLjBxcup3f6LQD2K4DC5EmDZx7ED9pJOm6DUj9rVsuOeidPnQZLqiaIcjjZ99WSHs363SSYA3/nWe/4/mg5dWtouwdJxeYX7PkepWpS0TCYKJOHaU6v75oBka8xI0xeHtSMd7vyr4p3vHJaYpbfJD5uc4I/BHnHyHfASHUa545cLbdRk5Vs2gO5S0EAi9mGFML8nNCo+ajmf3Ap68ebR6foxvF3T9GTn3Dxf7phoHmPQWtkLR0CorflztYdw8DWKN5pmrWmDRUvLDfGheoJt669OaEwtKibXjbft4ivgtpapAfRvNMpqKGqQvl77bBwwcRWUY9ER16XRhZdEBBFnszRJKzjpwIjMH0netJhoKwsFqwG3id+hZ2rQAV0Qzj4YyGZ7Zgpz1x0xWBCS5dwOCMgavcbQLfK3qYuQ0vMe72f2uSbRMaZ2J1HMmvfISP/oh1i3V4GPlpnOlcYmgqIaVli1+kn3rXNf2cRFaQaNrTG1ulP9XMUVBcHfOBeTOQmUQm8GNmP6l0rjqVd9bJx5PU5wtukyAm9jlz1vuMRLb0hd3Ta06Vc1a6K1krbypzuvARVqInnofoTGoDt6RQ1legL4LV6slCOO8srA0L93O2P+Hmk8j9XGHCNa1YuJz93mPdPsit06K8y9w9ZxOkdU6ovCJRiDiHlK7BaNh9fjEtL1T91PRZ2r3k6tybTbzvDH/LiDgfcWQvdfHBp8B6bLp1aq3bsemb1RzOnQPeIyBPCbCanzyouJS7EmmLGeFm/+33LRC32W6j1OS/aZwFjUZGMKqaC9wvQuyBrkjavvHmVIxRYQrWJ73KQ0R68kOCQNHDlChFirvhgd3zaHZJLZdh0CS23r6lDFnASZkZfkUUq7sGIiyMFUi9qht5cTDlen8wvjbhLWC9iog+AzaX443dX0mnJLX+FrpGwlw3uph7fLAr1IdbrGKsrCYMnFnazDSVgCxJE2Pl+IQ7R8eE4Aj29PLCvJkWHrQUAUPlPAXwpwzNsipt2WSA4+sF4MrIE/VXVginvDkdtiFSKn0wMDHCA5edgI52goEsd+8A2ross5t8Lx5S9xY/9xaIPbHJAHkqTdexwsqMSUwIwYJKoZIhvcNAQkVMRYEFOVtEkFQvB5Ycve1SafoHGd0TBWMMEEwMTANBglghkgBZQMEAgEFAAQgyAQbXMVMMJNCMz4xFdJz1ZrkiERLZEur7NT7OdCDgIQECESQPalqn/dSAgIIAA==''')

test_keystore_password = str.encode('Password')

test_certificate = load_pkcs12(data=test_keystore, password=test_keystore_password)

test_message = str.encode('Message')

test_signature = b64decode('''K8OeXtbN/tslfS6Q86NaIn/D0IAy3FgNoFGIDuNWFBUdcsaXy+wLalLVBU95+TDQ/fFmmMnoJX7mVYnpdryqDc9w9+zV9DuPdOOXd8dcsbmx/PnZYFeS6vuXXwltZ65W9xhhoKGauJC7H0QyMHE6lcHjd/Q31M3ELqu15IgtIzB5pZEuG/q7t9lo1+RdbunquoQeUxTeQSxHfqFWObYUbyksD/sJZEeukqNRNpSA/bPBS6GJuuV61Me1XcOH8Kwmt0pPbGAFnCZiHpb1UdXEhZx+6qIrs6T9VbTnW1Wtuy9OH/Ulv3sLp8Q6Z1W7NegGNSot3b8W5xrtTi/NIu2wUqOqc56TBfhe+IM8V10pCoieZYNX6pf1z3OwqVCZIMd5Ujj2zYPnKe9Kl1+1QEX9GK71UCOJ7XsqZOrJ3NEeOKolY1Zc/DwwPesaUqCGZbIaFccnFff3I4tJe+GPXNCmSGfKaq1YpfUiQhMsxpqGYV/GJdMNY554HMUSv1jvxNRc07Ce+eo4XwWJMGsNUH23DvZx92Ncykwy6XV/sjwG90ptCjn91P73lBuFlKC0X4AdoiNDIo2n2ZOyYj7E9+JUlSPxn/5GVLRWNfrfgS/qNOBmlPn0oi2ueLZ9qB1SApOlNRsy/jo4UCRNWjuJr7LgOQs/Tzus5cqrDy0V9Gw40PY=''')

test_wrong_signature = b64decode('''WRONGxvxdS8qnf6Ei3sL5hjvcKvtFx3bzR6qOysjHWSzHEYuUEj0sn5B+5NvBWCKknOTCbB/WMfC0ZgDeYeOqzwk2imG952+wllVzRnCDydbXxeHJOXt91vv+AreFrsPGhB0IoozEUarBgZ4XmoU9fw3EsBwFdKiv1c4gDmFx+v1XKspCbDTJw729dd7Lyt+2p9QZPFUoTjES+wfyCcexjpbuqT16919puouyWm0zxphMX05PkFDTm77/Zlu/GKnXTVDQDc7A0bxcaBerXtWyJWDgaRKkm5Oa0g6EZNTBdM70+2szU4cZH11WijXdIrHhRSseUJ0lh4Oh085I+wIBU3LzvEvvGIa4ecBEQA4CUglXAhaVf4Fsmu6uR7Be2HRkYvJ3v5xwFP7vxQbPg8lN/7rzzFoVjfMnvkFkqWzs7VlL5DGXr7cRLPrKwi5+uvYuixpOhbvemQvpxT9KvkkVMti6j6dI9p7Ep/fhVraV4yDSuk5wXrEMQ73MgVtjDJZNVKrWlZQ/Vj+AUYR3Kk8irY9yIFz3Yc0puVSqVAX0xFLdsbmrhk7a0Ak/xh/zCATgjSgJnT9it7frqsoP3kIAFTCgErZf2xILsJ0UBze1byZYdRwbNlS1a9v8pg/bu9O8egAa1juGYsLU5huCeKbRRzqKSzwy6i1gBwT1xx0XJw=''')
